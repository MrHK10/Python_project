{% extends "base.html" %}
{% block title %}company {% endblock title %}
{% block body %}

<div class="container">
    <div class="row">
        <div class="col-md-12 text-left" style="margin-bottom: 20px;">
            <a href="#addJobModal-{{forloop.counter}}" class="btn btn-success" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>Add New Job</span></a>
        </div>
    </div>
    <div class="row">
        {% for i in emp %}
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ i.company_name }}</h5>
                    <p class="card-text">
                        <strong>ID:</strong> {{ i.id }}<br>
                        <strong>Website:</strong> {{ i.company_website }}<br>
                        <strong>Address:</strong> {{ i.company_address }}<br>
                        <strong>Contact:</strong> {{ i.company_contact }}<br>
                        <strong>Source ID:</strong> {{ i.source_id }}
                    </p>
                    <a href="#editEmployeeModal-{{forloop.counter}}" class="btn btn-info" data-toggle="modal">Edit</a>
                    <a href="#deleteJobModal-{{forloop.counter}}" class="btn btn-danger" data-toggle="modal">Delete</a>
                    <a href="#detailsModal-{{forloop.counter}}" class="btn btn-primary" data-toggle="modal">Details</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="clearfix"></div>

<!-- Pagination moved to the bottom -->
<div class="pagination">
    <span class="step-links">
        {% if emp.has_previous %}
            <a href="?page=">&laquo; first</a>
            <a href="?page={{ emp.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ emp.number }} of {{ emp.paginator.num_pages }}.
        </span>

        {% if emp.has_next %}
            <a href="?page={{ emp.next_page_number }}">next</a>
            <a href="?page={{ emp.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
        
    <div class="clearfix">
        <div class="hint-text">Showing <b>{{ emp|length }}</b> entries</div>
    </div>
</div>

    {% comment %} <div class="clearfix">
    </div> {% endcomment %}

<!-- Add Modal HTML -->
{% comment %} {% for i in emp %} {% endcomment %}
<div id="addJobModal-{{forloop.counter}}" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="{% url 'dataAdd' %}" method="POST">
                {% csrf_token %}
                <div class="modal-header">						
                    <h4 class="modal-title">Add Employee</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">					
                    <div class="form-group">
                        <label>company_name</label>
                        <input  name= "company" type="text" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>company_website</label>
                        <input name="website" type="url" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>company_address</label>
                        <textarea name="address_company" class="form-control" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>company_contact</label>
                        <input name="company_contact" type="text" class="form-control" required>
                    </div>					
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-success" value="Add">
                </div>
            </form>
        </div>
    </div>
</div>
{% comment %} {% endfor %} {% endcomment %}

{% for i in emp %}
<div id="detailsModal-{{ forloop.counter }}" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Details - {{ i.company_name }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <p><strong>ID:</strong> {{ i.id }}</p>
                <p><strong>Website:</strong> {{ i.company_website }}</p>
                <p><strong>Address:</strong> {{ i.company_address }}</p>
                <p><strong>Contact:</strong> {{ i.company_contact }}</p>
                <p><strong>Source ID:</strong> {{ i.source_id }}</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- Edit Modal HTML -->

{% for i in emp %}
<div id="editEmployeeModal-{{forloop.counter}}" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="{% url 'updatecompanylist' id=i.id %}" method="POST">
                {% csrf_token %}
                <div class="modal-header">						
                    <h4 class="modal-title">Edit Employee</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">					
                    <div class="form-group">
                        <label>company_name</label>
                        <input name= "company" value="{{i.company_name}}" type="text" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>company_website</label>
                        <input name="website" value="{{i.company_website}}" type="url" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>company_address</label>
                        <textarea name="address_company"  class="form-control" required>{{i.company_address}}</textarea>
                    </div>
                    <div class="form-group">
                        <label>company_contact</label>
                        <input name="company_contact" value="{{i.company_contact}}" type="text" class="form-control" required>
                    </div>					
                </div>	
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-info" value="Save">
                </div>
            </form>
        </div>
    </div>
</div>
{%endfor%}



<!-- Delete Modal HTML -->
{% for i in emp %}
<div id="deleteJobModal-{{forloop.counter}}" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form>
                <div class="modal-header">						
                    <h4 class="modal-title">Delete Employee</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">					
                    <p>Are you sure you want to delete these Records?</p>
                    <p class="text-warning"><small>This action cannot be undone.</small></p>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <a  href="/delete2/{{i.id}}" type="submit" class="btn btn-danger">Delete</a>
                </div>
            </form>
        </div>
    </div>
</div>
{%endfor%}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function(){
        // Activate tooltip
        $('[data-toggle="tooltip"]').tooltip();
        
        // Trigger the modal using JavaScript
        $(document).on('click', '[data-toggle="modal"]', function () {
            var targetModal = $(this).attr('href');
            $(targetModal).modal('show');
        });
    });
</script>

{% endblock body %}